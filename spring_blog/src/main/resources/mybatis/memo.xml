<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="memo">
	<select id="total" parameterType="Map" resultType="int">
		select count(*) FROM memo
			<where>
				<if test="col=='title'">
					title like '%'||#{word}||'%'
				</if>
				<if test="col=='content'">
					content like '%'||#{word}||'%'
				</if>
			</where>
	</select>
	<select id="list" parameterType="Map" resultType="memoDTO">
		SELECT memono, title, to_char(wdate, 'yyyy-mm-dd') wdate, viewcnt, r
		FROM(                                                            
			SELECT memono, title, wdate, viewcnt, rownum r               
			FROM(                                                   
				SELECT memono, title, wdate, viewcnt                     
				FROM memo
				<where>
					<if test="col=='title'">
						title like '%'||#{word}||'%'
					</if>
					<if test="col=='content'">
						content like '%'||#{word}||'%'
					</if>
				</where>
				ORDER BY memono DESC
				)
			)
			<![CDATA[
			WHERE r >= #{sno} and r <= #{eno}
			]]>
	</select>
</mapper>